{"version":3,"file":"main-context.js","sourceRoot":"","sources":["../../src/main/integrations/main-context.ts"],"names":[],"mappings":";;;AAAA,uCAA6C;AAG7C,uCAA+B;AAE/B,yCAA2D;AAC3D,wCAA8C;AAE9C,4DAA4D;AAC5D,MAAa,WAAW;IAAxB;QAIE,kBAAkB;QACX,SAAI,GAAW,WAAW,CAAC,EAAE,CAAC;IAcvC,CAAC;IAZC,kBAAkB;IACX,SAAS,CAAC,uBAA2D;;QAC1E,MAAM,OAAO,GAAG,MAAA,IAAA,oBAAa,GAAE,CAAC,SAAS,EAAc,0CAAE,UAAU,EAAE,CAAC;QAEtE,uBAAuB,CAAC,CAAO,KAAY,EAAE,EAAE;YAC7C,MAAM,UAAU,GAAG,IAAA,uBAAc,EAAC,KAAK,EAAE,cAAG,CAAC,UAAU,EAAE,CAAC,CAAC;YAC3D,MAAM,QAAQ,GAAG,MAAM,IAAA,0BAAgB,EAAC,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,CAAC,CAAC;YAC1D,MAAM,SAAS,GAAG,IAAA,oBAAW,EAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAEpD,OAAO,SAAS,CAAC;QACnB,CAAC,CAAA,CAAC,CAAC;IACL,CAAC;;AAlBH,kCAmBC;AAlBC,kBAAkB;AACJ,cAAE,GAAW,aAAa,CAAC","sourcesContent":["import { getCurrentHub } from '@sentry/core';\nimport { NodeClient } from '@sentry/node';\nimport { Event, EventProcessor, Integration } from '@sentry/types';\nimport { app } from 'electron';\n\nimport { mergeEvents, normalizeEvent } from '../../common';\nimport { getEventDefaults } from '../context';\n\n/** Adds Electron context to events and normalises paths. */\nexport class MainContext implements Integration {\n  /** @inheritDoc */\n  public static id: string = 'MainContext';\n\n  /** @inheritDoc */\n  public name: string = MainContext.id;\n\n  /** @inheritDoc */\n  public setupOnce(addGlobalEventProcessor: (callback: EventProcessor) => void): void {\n    const options = getCurrentHub().getClient<NodeClient>()?.getOptions();\n\n    addGlobalEventProcessor(async (event: Event) => {\n      const normalized = normalizeEvent(event, app.getAppPath());\n      const defaults = await getEventDefaults(options?.release);\n      const fullEvent = mergeEvents(defaults, normalized);\n\n      return fullEvent;\n    });\n  }\n}\n"]}